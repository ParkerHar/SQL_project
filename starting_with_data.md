**Question 1: Which marketing tactics (channel_group) generate the most visits? Are the visits quality or do the users leave quickly?**

**SQL Queries:**
 
```sql
SELECT	channel_group,
		AVG(time_on_site/60) AS avg_visit_time,
		RANK() OVER (ORDER BY AVG(time_on_site/60) DESC) AS avg_time_rank,
		SUM(time_on_site/60) AS total_visit_time,
		RANK() OVER (ORDER BY SUM(time_on_site/60) DESC) AS total_time_rank,
		COUNT(*) AS number_of_visits,
		RANK() OVER (ORDER BY COUNT(*) DESC) AS visit_rank
FROM	web_analytics
GROUP BY	channel_group
ORDER BY	number_of_visits DESC
```

**Answer:**

Organic searches result in the most visits but have one of the lowest average visit times indicating these may not be 'quality' visits.

Referalls seem to be one of the best generators when viewed holistically. It has a high number of visits and a high average visit time. It could be worth putting more spend into referall marketing as it results in high average visit times


**Question 2:**
What are the number of visits generated by each channel group per month? Include the percentage of visits by month

SQL Queries:
```sql
SELECT	EXTRACT (MONTH FROM date) AS month,
		channel_group,
		COUNT (*) AS visit_per_group,
		SUM(COUNT (*)) OVER (PARTITION BY(EXTRACT (MONTH FROM date))) AS visits_per_month,
		(COUNT (*)/(SUM(COUNT (*)) OVER (PARTITION BY(EXTRACT (MONTH FROM date)))))*100 AS percentage_of_visits
FROM	web_analytics
GROUP BY 	EXTRACT (MONTH FROM date),
			channel_group
ORDER BY	month,
			percentage_of_visits DESC
```

**Answer:**

Organic searches, Referrals, and Direct channels dominate the drivers for number of visits per month with Organic searches accounting for around 48% of visits month over month.


**Question 3: Which product generated the most revenue?**

**SQL Queries:**

`sales view was created to add in product name for answer to this question`
```sql
CREATE VIEW sales AS
	SELECT	sbs.sku,
		sbs.total_ordered,
		pr.product_name
	FROM	sales_by_sku	sbs
	JOIN	products		pr
	ON		sbs.sku = pr.sku
```
```sql
WITH	sales_and_price AS
		(SELECT	s.sku,
				s.total_ordered,
				s.product_name,
				AVG(cs.product_price)/1000000 AS price
		FROM	sales			s
		JOIN	clean_sessions	cs
		ON		s.sku = cs.sku
		GROUP BY	s.sku,
					s.total_ordered,
					s.product_name)

SELECT	sku,
		product_name,
		total_ordered * price AS revenue
FROM	sales_and_price
WHERE	total_ordered * price > 0
ORDER BY revenue DESC
```

**Answer:**

The top product by revenue was the 'Learning Thermostat 3rd Gen-USA - Stainless Steel'





